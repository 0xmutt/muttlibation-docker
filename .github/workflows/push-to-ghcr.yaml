---
  name: Build and publish a Docker image to ghcr.io
  on:
    release:
      types:
        - published
    push:
      branches:
        - main
  jobs:
    docker_publish:
      runs-on: ubuntu-latest
      steps:
        - uses: actions/checkout@v2
        - name: Fix inotify instances
          run: >
            echo fs.inotify.max_user_instances=524288 | sudo tee -a /etc/sysctl.conf
  
            sudo sysctl -p
        - name: Build and publish a Docker image for ${{ github.repository }}
          uses: 0xmutt/push-to-ghcr@main
          with:
            image_name: ${{ github.repository }}
            github_token: ${{ secrets.GITHUB_TOKEN }}
  